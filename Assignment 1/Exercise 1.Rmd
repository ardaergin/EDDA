---
title: "Exercise 1"
author: "Adam Sulak, Onder Akacik"
date: "2024-02-22"
output: html_document
---

## Question A)
We first load `Ice_cream-1.csv`.
```{r}
data <- read.table("./Ice_cream-1.csv", header = TRUE, sep = ",")
```

We then proceed with confirming normality assumption. The qqplot and histogram show us that data is
normaly distributed.
```{r}
mu <- mean(data$video)
hist(data$video)
qqnorm(data$video)
plot(density(data$video))
boxplot(data$video)
```

Next we calculate .97 confidence interval for the video data.
```{r}
n <- length(data$video)
sd_sample <- sd(data$video)
sem <- sd_sample / sqrt(n)
z_score <- qnorm(1 - 0.015)
margin_error <- z_score * sem
lower_bound <- mu - margin_error
upper_bound <- mu + margin_error
lower_bound; upper_bound
```

Then we proceed with calculating interval length<=3 (Answer: 205.17)
```{r}
n_min = (z_score^2) * (sd_sample^2) / (1.5^2)
n_min
```

After than we calculate confidence interval using bootstraping. We take 10 000 boostrap samples to get a good
approximation.
```{r}
# BOOTSTRAP 97% CONFIDENCE INTERVAL
b_count <- 10000
bootstrap_stat <- numeric(b_count)
for (i in 1:b_count) {
    bootstrap_sample <- sample(data$video, replace=TRUE)
    bootstrap_stat[i] <- mean(bootstrap_sample)
}
hist(bootstrap_stat)
boxplot(bootstrap_stat)

bootstrap_conf_int <- quantile(bootstrap_stat, c(0.015, 0.985))
s <- sum(bootstrap_stat<bootstrap_conf_int[1])
bootstrap_conf_int_check <- c(2*mu-bootstrap_conf_int[2] ,2*mu-bootstrap_conf_int[1])
bootstrap_conf_int
```
## Question B)
We use one-sample T-test to check if mean score is larger than 50.
```{r}
t_test_result <- t.test(data$video, mu = 50, alternative = "greater")
t_test_result
```
Since we are interested in a score that is _greater_ than 50 we perform one-tailed test. in such test
we reject Null hypothesis when tested mean (not sample mean!) is so low that is is outside of the confidence interval. In one-tailed test such confidence interval will span some real value for the lower bound and infinity in the upper bound. When value of the mean is lower that the lower bound of this Confidence Interval then we can say with high confidence that mean of population is lower than the tested mean. In this test we **reject Null hypothesis**

```{r}
t_test51_result <- t.test(data$video, mu = 51, alternative = "greater")
t_test51_result
```
For the test with mean equal to 51 we have the same CI but result of the test is different.
Real mean of the sample is 51.85 which is higher than that tested mean of 51. However that tested mean is still
within confidence interval so we cannot be sure with high certainty that actual population mean is higher. The p-value
is equal to 0.113 which exceed 0.05 threshold.


## Question C)
First we run sign and Wilcoxon test to check if median score of video game is larger than 50.
```{r}
# SIGN TEST
test_median <- 50
larger_median <- sum(data$video > test_median)
sign_result <- binom.test(larger_median, n, conf.level = .97, alternative = 'greater')

wilcox_result <- wilcox.test(data$video, mu=50, alternative = 'greater')
sign_result; wilcox_result
```
Next we perform sign test with modified parameters to check if 25 % of results are less than 42.
```{r}
#wilcox_25_result <- wilcox.test(data$video, mu=42, alternative = 'less') # not sure if this one is correct

count_lt_42 <- sum(data$video < 42)

# both should be the same tests
sign_25_result <- binom.test(count_lt_42, n, p = 0.25, alternative = "less")
#prop_25_result <- prop.test(x = count_lt_42, n = n, p = 0.25, alternative = "less")
sign_25_result
```

## Question D)
```{r}
b2_count <- 10000
b2_stat <- numeric(b2_count)
for (i in 1:b2_count) {
    b2_sample <- sample(data$video, replace=TRUE)
    b2_stat[i] <- min(b2_sample)
}
```

## Question E)

Since we know that sample comes from normal distribution two sample t test is a most suitable test to perform.
We also perform Wilcoxon and Kolmogorov-Smirnov test and explain below the caveats.
```{r}
vid_female <- data$video[data$female==1]
vid_male <- data$video[data$female==0]

mf_t_result <- t.test(vid_male, vid_female, alternative = 'greater')
mf_wilcox_result <- wilcox.test(vid_male, vid_female, alternative = 'greater')
mf_ks_result <- ks.test(vid_male, vid_female, alternative = 'greater')

mf_t_result; mf_wilcox_result; mf_ks_result
```
Wlcoxon test compares medians of two samples not means, however it can still give us a good idea about the differences between samples.

Kolmogorov-Smirnov test is used to check if two samples come from the same distribution or if one sample comes
from normal distribution, here our goal is to check if mean of one sample is higher than a mean
of a second sample which means KS test is incorrect test to perform.

## Question F)
We run Pearson correlation test.
```{r}
video_puzzle <- data[c('video', 'puzzle')]
cor_result <- round(cor(video_puzzle), 3)
pairs(video_puzzle)
cor_test_result <- cor.test(video_puzzle$video, video_puzzle$puzzle)
t_result <- t.test(video_puzzle$puzzle, video_puzzle$video, alternative = 'greater', paired = TRUE)
#t_result <- t.test(video_puzzle$puzzle, video_puzzle$video)
cor_result; t_result
```
The p-value resulting from the test is 0.232 therefore **alternative hypothesis is rejected**.