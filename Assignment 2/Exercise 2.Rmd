---
title: "Exercise 1"
author: "Adam Sulak, Onder Akacik, Arda Ergin"
date: "2024-02-22"
output:
  pdf_document: default
  html_document: default
---

```{r}
options(digits=3)

library(dplyr)
library(ggplot2)
library(car)
library(corrplot)
library(glmnet)
color_choice <- "Dark2"
```


# Exercise 2

```{r}
data <- read.csv("Birthweight.csv")
```


## Question 2a)
```{r}
model <- lm(
    Birthweight ~ Length + Headcirc + Gestation + mage + mnocig + mheight + mppwt + fage + fedyrs + fnocig + fheight,
    data = data
)
#model <- lm(Birthweight ~ ., data = data)
summary(model)
```


```{r}
par(mfrow=c(2,2))
plot(model)


resid_ordered <- order(abs(residuals(model)))
u = rep(0,length(resid_ordered))
u[length(resid_ordered)] = 1

cooks.distance(model)
plot(cooks.distance(model), type="b")

forbeslm_42 = lm(y~x+u11); summary(forbeslm11)
```


Collinearity:
```{r}
car::vif(model)
```

no variables have a VIF value that is higher than 5

```{r}
# Calculate correlation matrix
cor_matrix <- cor(data[, -c(1,3)]) # Exclude response variable Birthweight

# Plot the correlation matrix
corrplot(cor_matrix, 
         method = "circle", type = "upper", tl.col = "black", tl.cex = 0.6)
```



## Question 2b)

```{r}
step_down_model <- step(model, direction = 'backward')
summary(step_down_model)
par(mfrow = c(1,2))
plot(step_down_model)
```



## Question 2c)

```{r}
ci <- confint.lm(step_down_model)
pi <- predict(step_down_model, interval = 'prediction')
ci; pi
```

## Question 2d)

LASSO method
```{r}
lasso_model <- glmnet(
    subset(data, select = -c(data$Birthweight)),
    data$Birthweight,
    alpha = 1
)
plot(lasso_model, xvar="lambda", label = TRUE)
```


## Question 2e)
```{r}
smoke_model_all <- lm( lowbwt ~ Gestation+smoker+mage35, data=data)
summary(smoke_model_all)

m1 <- lm(lowbwt ~ Gestation+smoker, data=data)
m2 <- lm(lowbwt ~ Gestation+mage35, data=data)
m3 <- lm(lowbwt ~ smoker+mage35, data=data)
summary(m1); summary(m2); summary(m3)
smoke_step_down <- step(smoke_model_all, direction = 'backward')
```
Using drop down methods we conclude age has no significance. We select Gestation and smoker parameters.
## Question 2f)


## Question 2g)


## Question 2h)


## Question 2i)


