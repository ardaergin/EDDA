---
title: "Exercise 1"
author: "Adam Sulak, Onder Akacik, Arda Ergin"
date: "2024-02-22"
output:
  pdf_document: default
  html_document: default
---

```{r}
options(digits=3)

library(dplyr)
library(ggplot2)
library(car)
library(corrplot)
library(glmnet)
color_choice <- "Dark2"
```


# Exercise 2

```{r}
data <- read.csv("Birthweight.csv")
```


## Question 2a)
```{r}
model <- lm(Birthweight ~ Length + Headcirc + Gestation + mage + mnocig + mheight + mppwt + fage + fedyrs + fnocig + fheight, data = data)
#model <- lm(Birthweight ~ ., data = data)
summary(model)
```


```{r}
par(mfrow=c(2,2))
plot(model)


resid_ordered <- order(abs(residuals(model)))
u = rep(0,length(resid_ordered))
u[length(resid_ordered)] = 1

cooks.distance(model)
plot(cooks.distance(model), type="b")

forbeslm_42 = lm(y~x+u11); summary(forbeslm11)
```


Collinearity:
```{r}
car::vif(model)
```

no variables have a VIF value that is higher than 5

```{r}
# Calculate correlation matrix
cor_matrix <- cor(data[, -c(1,3)]) # Exclude response variable Birthweight

# Plot the correlation matrix
corrplot(cor_matrix, method = "circle", type = "upper", tl.col = "black", tl.cex = 0.6)
```



## Question 2b)

```{r}
all_model <- lm(Birthweight ~ ., data=data)
step_down_model <- step(all_model, direction = 'backward')
summary(step_down_model)
par(mfrow = c(1,2))
plot(step_down_model)
```



## Question 2c)

```{r}
ci <- confint.lm(step_down_model)
pi <- predict(step_down_model, interval = 'prediction')
ci; pi
```

## Question 2d)

LASSO method
```{r}
lasso_model <- glmnet(subset(data, select = -c(data$Birthweight)), data$Birthweight, alpha = 1)
plot(lasso_model, xvar="lambda")
```


## Question 2e)
```{r}
smoke_model <- lm( lowbwt ~ Gestation+smoker+mage35, data=data)
```
## Question 2f)


## Question 2g)


## Question 2h)


## Question 2i)


